#!/bin/bash

# Hotpaws GitHub Push Script
# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

set -e

cd "$(dirname "$0")/.."

echo "üêæ Hotpaws GitHub Push"
echo "====================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –º—ã –≤ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
if [ ! -d .git ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: —ç—Ç–æ –Ω–µ git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"
    exit 1
fi

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
echo "üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:"
git status --short
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
if [ -z "$(git status --porcelain)" ]; then
    echo "‚úÖ –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –∫–æ–º–º–∏—Ç–∞"
    echo ""
    read -p "–ó–∞–ø—É—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–º–∏—Ç—ã? (y/n) " -n 1 -r
    echo ""
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        git push origin main
        echo ""
        echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ GitHub"
    fi
    exit 0
fi

# –°–ø—Ä–∞—à–∏–≤–∞–µ–º —á—Ç–æ –¥–µ–ª–∞—Ç—å
echo "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"
echo "1) –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å"
echo "2) –í—ã–±–æ—Ä–æ—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã"
echo "3) –¢–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å"
read -p "–í–∞—à –≤—ã–±–æ—Ä (1/2/3): " choice

case $choice in
    1)
        git add -A
        echo ""
        echo "üìù –§–∞–π–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã. –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞:"
        read -p "> " commit_msg
        
        if [ -z "$commit_msg" ]; then
            echo "‚ùå –°–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º"
            exit 1
        fi
        
        git commit -m "$commit_msg"
        echo ""
        read -p "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub? (y/n) " -n 1 -r
        echo ""
        if [[ $REPLY =~ ^[Yy]$ ]]; then
            git push origin main
            echo ""
            echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ GitHub"
            echo "üîó https://github.com/listeomin/hotpaws"
        fi
        ;;
    2)
        echo ""
        echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: git add <—Ñ–∞–π–ª>"
        echo "–ó–∞—Ç–µ–º: git commit -m '—Å–æ–æ–±—â–µ–Ω–∏–µ'"
        echo "–ò: git push origin main"
        ;;
    3)
        echo ""
        git status
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä"
        exit 1
        ;;
esac

echo ""
echo "‚ú® –ì–æ—Ç–æ–≤–æ!"
